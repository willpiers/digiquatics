<% provide(:title, 'Certifications') %>
<h1>Certifications</h1>
<ul class = "pull-right">
  <%= link_to "Manage Certifications", certification_names_path, class: "btn btn-primary" %>
</ul>
<br>
<br>
<br>
<table class="table table-hover">
  <thead>
    <tr>
      <th><%= link_to "First Name", sort: 'users.first_name' %></th>
      <th><%= link_to "Last Name", sort: "last_name" %></th>
      <th><%= link_to "Location", sort: "location" %></th>
        <% @certification_names.each do |certification_name| %>
          <th><%= certification_name.name %></th>
        <% end %>
    </tr>
  </thead>
  <tbody>
    <% @certifications.each do |row| %>
      <tr>
        <td><%= link_to row.user.first_name, row.user  %></td>
        <td><%= link_to row.user.last_name, row.user %></td>
        <td><%= row.user.location.name %></td>
        <% row.user.certifications.each do |cert| %>
          <% if cert.expiration_date <= ( Date.today) %>
            <td class="danger">
              <%= cert.expiration_date.strftime('%-m/%-d/%Y') %>
            </td>
          <% elsif cert.expiration_date > ( Date.today ) && cert.expiration_date < ( Date.today + 60.days ) %>
            <td class="warning">
              <%= cert.expiration_date.strftime('%-m/%-d/%Y') %>
            </td>
          <% elsif cert.expiration_date >= ( Date.today + 60.days ) %>
            <td class="success">
              <%= cert.expiration_date.strftime('%-m/%-d/%Y') %>
            </td>
          <% end %>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>


